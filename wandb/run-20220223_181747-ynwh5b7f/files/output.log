<Monitor<TimeLimit<CartPoleEnv<CartPole-v1>>>>
EnvSpec(CartPole-v1)
Box([-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38], [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38], (4,), float32)
Discrete(2)
example transition
OrderedDict([('obs', array([ 3.577053e-01, -2.921387e+37,  4.023691e-01,  8.954089e+37],
      dtype=float32)), ('action', 0), ('reward', 0.0), ('done', False)])
buffer spec
[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')]
Agent(
  (actor): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=2, bias=True)
    (5): Softmax(dim=-1)
  )
  (critic): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
4
{'pg loss': -0.09358762204647064, 'value loss': 1123175018528768.0, 'entropy': 0.08477085083723068}
{'average_length': 32.0, 'average_return': 32.0, 'max_length': 42, 'max_return': 42.0}
8
{'pg loss': -0.3599624037742615, 'value loss': 1439298570158080.0, 'entropy': 0.18173041939735413}
{'average_length': 31.0, 'average_return': 31.0, 'max_length': 42, 'max_return': 42.0}
12
{'pg loss': 0.17592178285121918, 'value loss': 545497756467200.0, 'entropy': 0.07983001321554184}
{'average_length': 31.272727272727273, 'average_return': 31.272727272727273, 'max_length': 42, 'max_return': 42.0}
16
{'pg loss': 0.1765405237674713, 'value loss': 546397015244800.0, 'entropy': 0.10971440374851227}
{'average_length': 30.866666666666667, 'average_return': 30.866666666666667, 'max_length': 42, 'max_return': 42.0}
20
{'pg loss': -0.14224179089069366, 'value loss': 1252326832603136.0, 'entropy': 0.0691959410905838}
{'average_length': 30.736842105263158, 'average_return': 30.736842105263158, 'max_length': 42, 'max_return': 42.0}
24
{'pg loss': -0.1601332724094391, 'value loss': 1226136658903040.0, 'entropy': 0.1496695578098297}
{'average_length': 30.782608695652176, 'average_return': 30.782608695652176, 'max_length': 42, 'max_return': 42.0}
28
{'pg loss': -0.13866466283798218, 'value loss': 1180681006743552.0, 'entropy': 0.07212777435779572}
{'average_length': 30.962962962962962, 'average_return': 30.962962962962962, 'max_length': 42, 'max_return': 42.0}
32
{'pg loss': -0.041668977588415146, 'value loss': 581353485631488.0, 'entropy': 0.09529826790094376}
{'average_length': 31.483870967741936, 'average_return': 31.483870967741936, 'max_length': 44, 'max_return': 44.0}
36
{'pg loss': 0.024654746055603027, 'value loss': 249802344366080.0, 'entropy': 0.1862068474292755}
{'average_length': 31.542857142857144, 'average_return': 31.542857142857144, 'max_length': 44, 'max_return': 44.0}
39
{'pg loss': 0.13438254594802856, 'value loss': 551656236253184.0, 'entropy': 0.14373192191123962}
{'average_length': 31.68421052631579, 'average_return': 31.68421052631579, 'max_length': 44, 'max_return': 44.0}
43
{'pg loss': 0.09801051765680313, 'value loss': 545743274246144.0, 'entropy': 0.13800102472305298}
{'average_length': 31.857142857142858, 'average_return': 31.857142857142858, 'max_length': 44, 'max_return': 44.0}
47
{'pg loss': -0.1412939429283142, 'value loss': 1063171104178176.0, 'entropy': 0.09912911802530289}
{'average_length': 31.717391304347824, 'average_return': 31.717391304347824, 'max_length': 44, 'max_return': 44.0}
51
{'pg loss': 0.09745052456855774, 'value loss': 249802344366080.0, 'entropy': 0.10179007798433304}
{'average_length': 31.88, 'average_return': 31.88, 'max_length': 44, 'max_return': 44.0}
54
{'pg loss': -0.12369846552610397, 'value loss': 1060320655179776.0, 'entropy': 0.10663383454084396}
{'average_length': 31.962264150943398, 'average_return': 31.962264150943398, 'max_length': 44, 'max_return': 44.0}
58
{'pg loss': 0.07035589218139648, 'value loss': 511279248703488.0, 'entropy': 0.08881119638681412}
{'average_length': 32.19298245614035, 'average_return': 32.19298245614035, 'max_length': 44, 'max_return': 44.0}
61
{'pg loss': -0.12664420902729034, 'value loss': 1273319424786432.0, 'entropy': 0.12724797427654266}
{'average_length': 32.11666666666667, 'average_return': 32.11666666666667, 'max_length': 44, 'max_return': 44.0}
66
{'pg loss': 0.3151901066303253, 'value loss': 112528084434944.0, 'entropy': 0.17722076177597046}
{'average_length': 31.96923076923077, 'average_return': 31.96923076923077, 'max_length': 47, 'max_return': 47.0}
70
{'pg loss': 0.12628048658370972, 'value loss': 4.145320415496826, 'entropy': 0.05425863340497017}
{'average_length': 32.11594202898551, 'average_return': 32.11594202898551, 'max_length': 47, 'max_return': 47.0}
72
{'pg loss': 0.1709541231393814, 'value loss': 306417462411264.0, 'entropy': 0.16848354041576385}
{'average_length': 32.7887323943662, 'average_return': 32.7887323943662, 'max_length': 86, 'max_return': 86.0}
76
{'pg loss': 0.014166691340506077, 'value loss': 489703782481920.0, 'entropy': 0.08369341492652893}
{'average_length': 32.56, 'average_return': 32.56, 'max_length': 86, 'max_return': 86.0}
79
{'pg loss': 0.18666210770606995, 'value loss': 234939106721792.0, 'entropy': 0.20809344947338104}
{'average_length': 33.05128205128205, 'average_return': 33.05128205128205, 'max_length': 86, 'max_return': 86.0}
83
{'pg loss': 0.04049702361226082, 'value loss': 593066129883136.0, 'entropy': 0.10654380172491074}
{'average_length': 32.90243902439025, 'average_return': 32.90243902439025, 'max_length': 86, 'max_return': 86.0}
86
{'pg loss': -0.25168338418006897, 'value loss': 1417149960683520.0, 'entropy': 0.0709698498249054}
{'average_length': 33.04705882352941, 'average_return': 33.04705882352941, 'max_length': 86, 'max_return': 86.0}
91
{'pg loss': -0.254469096660614, 'value loss': 265605894635520.0, 'entropy': 0.2260395586490631}
{'average_length': 32.86666666666667, 'average_return': 32.86666666666667, 'max_length': 86, 'max_return': 86.0}
95
{'pg loss': 0.007768264506012201, 'value loss': 569329389142016.0, 'entropy': 0.18092462420463562}
{'average_length': 32.638297872340424, 'average_return': 32.638297872340424, 'max_length': 86, 'max_return': 86.0}
98
{'pg loss': 0.03692397475242615, 'value loss': 859441947738112.0, 'entropy': 0.19269338250160217}
{'average_length': 32.76288659793814, 'average_return': 32.76288659793814, 'max_length': 86, 'max_return': 86.0}
102
{'pg loss': 0.18307891488075256, 'value loss': 454588029206528.0, 'entropy': 0.12834562361240387}
{'average_length': 32.81, 'average_return': 32.81, 'max_length': 86, 'max_return': 86.0}
106
{'pg loss': 0.21520639955997467, 'value loss': 471020943179776.0, 'entropy': 0.08863318711519241}
{'average_length': 32.62, 'average_return': 32.62, 'max_length': 86, 'max_return': 86.0}
109
{'pg loss': 0.18813371658325195, 'value loss': 635216737599488.0, 'entropy': 0.08590388298034668}
{'average_length': 32.81, 'average_return': 32.81, 'max_length': 86, 'max_return': 86.0}
114
{'pg loss': 0.014134661294519901, 'value loss': 220960229687296.0, 'entropy': 0.17736801505088806}
{'average_length': 32.88, 'average_return': 32.88, 'max_length': 86, 'max_return': 86.0}
117
{'pg loss': -0.2013573944568634, 'value loss': 3.40974497795105, 'entropy': 0.2728251814842224}
{'average_length': 32.91, 'average_return': 32.91, 'max_length': 86, 'max_return': 86.0}
122
{'pg loss': -0.07743528485298157, 'value loss': 912407148888064.0, 'entropy': 0.14720794558525085}
{'average_length': 32.7, 'average_return': 32.7, 'max_length': 86, 'max_return': 86.0}
127
{'pg loss': 0.1129293292760849, 'value loss': 265605894635520.0, 'entropy': 0.1388879120349884}
{'average_length': 32.48, 'average_return': 32.48, 'max_length': 86, 'max_return': 86.0}
130
{'pg loss': 0.21806345880031586, 'value loss': 3.606100082397461, 'entropy': 0.17358464002609253}
{'average_length': 32.53, 'average_return': 32.53, 'max_length': 86, 'max_return': 86.0}
134
{'pg loss': 0.01965506188571453, 'value loss': 835849155510272.0, 'entropy': 0.13240955770015717}
{'average_length': 32.39, 'average_return': 32.39, 'max_length': 86, 'max_return': 86.0}
138
{'pg loss': 0.092638298869133, 'value loss': 195448224612352.0, 'entropy': 0.07010794430971146}
{'average_length': 32.67, 'average_return': 32.67, 'max_length': 86, 'max_return': 86.0}
142
{'pg loss': -0.16091755032539368, 'value loss': 500545018134528.0, 'entropy': 0.09855522215366364}
{'average_length': 32.53, 'average_return': 32.53, 'max_length': 86, 'max_return': 86.0}
145
{'pg loss': 0.031563661992549896, 'value loss': 2.9956932067871094, 'entropy': 0.13384918868541718}
{'average_length': 32.59, 'average_return': 32.59, 'max_length': 86, 'max_return': 86.0}
150
{'pg loss': 0.12218151986598969, 'value loss': 2.5751612186431885, 'entropy': 0.14593228697776794}
{'average_length': 32.47, 'average_return': 32.47, 'max_length': 86, 'max_return': 86.0}
153
{'pg loss': 0.06822510808706284, 'value loss': 548601407209472.0, 'entropy': 0.1484660506248474}
{'average_length': 32.48, 'average_return': 32.48, 'max_length': 86, 'max_return': 86.0}
157
{'pg loss': -0.13204900920391083, 'value loss': 1074799459696640.0, 'entropy': 0.12633998692035675}
{'average_length': 32.32, 'average_return': 32.32, 'max_length': 86, 'max_return': 86.0}
161
{'pg loss': 0.1038026511669159, 'value loss': 289651722027008.0, 'entropy': 0.14902359247207642}
{'average_length': 32.32, 'average_return': 32.32, 'max_length': 86, 'max_return': 86.0}
165
{'pg loss': 0.0073294504545629025, 'value loss': 418758170509312.0, 'entropy': 0.11342144757509232}
{'average_length': 32.34, 'average_return': 32.34, 'max_length': 86, 'max_return': 86.0}
168
{'pg loss': 0.019036080688238144, 'value loss': 924137241444352.0, 'entropy': 0.03687012195587158}
{'average_length': 32.43, 'average_return': 32.43, 'max_length': 86, 'max_return': 86.0}
172
{'pg loss': -0.5139378309249878, 'value loss': 835713125842944.0, 'entropy': 0.223920077085495}
{'average_length': 32.0, 'average_return': 32.0, 'max_length': 57, 'max_return': 57.0}
176
{'pg loss': 0.08997199684381485, 'value loss': 551643049361408.0, 'entropy': 0.08773200958967209}
{'average_length': 32.08, 'average_return': 32.08, 'max_length': 57, 'max_return': 57.0}
180
{'pg loss': -0.5453256964683533, 'value loss': 220960229687296.0, 'entropy': 0.24403277039527893}
{'average_length': 31.73, 'average_return': 31.73, 'max_length': 54, 'max_return': 54.0}
184
{'pg loss': 0.11439760029315948, 'value loss': 549909325414400.0, 'entropy': 0.1485232710838318}
{'average_length': 31.64, 'average_return': 31.64, 'max_length': 54, 'max_return': 54.0}
188
{'pg loss': 0.21813730895519257, 'value loss': 495483835383808.0, 'entropy': 0.09818913042545319}
{'average_length': 31.36, 'average_return': 31.36, 'max_length': 54, 'max_return': 54.0}
191
{'pg loss': -0.08551659435033798, 'value loss': 2.2082839012145996, 'entropy': 0.1441311538219452}
{'average_length': 31.69, 'average_return': 31.69, 'max_length': 54, 'max_return': 54.0}
195
{'pg loss': -0.17444166541099548, 'value loss': 1279261914693632.0, 'entropy': 0.1346372365951538}
{'average_length': 31.87, 'average_return': 31.87, 'max_length': 54, 'max_return': 54.0}
199
{'pg loss': -0.16251279413700104, 'value loss': 1064142572093440.0, 'entropy': 0.11536436527967453}
{'average_length': 31.65, 'average_return': 31.65, 'max_length': 54, 'max_return': 54.0}
203
{'pg loss': -0.2737429141998291, 'value loss': 1361756425289728.0, 'entropy': 0.15677325427532196}
{'average_length': 31.74, 'average_return': 31.74, 'max_length': 54, 'max_return': 54.0}
207
{'pg loss': -0.09528044611215591, 'value loss': 1128746664853504.0, 'entropy': 0.08028847724199295}
{'average_length': 31.67, 'average_return': 31.67, 'max_length': 54, 'max_return': 54.0}
211
{'pg loss': -0.07675772160291672, 'value loss': 1023557748391936.0, 'entropy': 0.08496052026748657}
{'average_length': 31.33, 'average_return': 31.33, 'max_length': 54, 'max_return': 54.0}
216
{'pg loss': 0.12441547214984894, 'value loss': 2.1922924518585205, 'entropy': 0.05374126136302948}
{'average_length': 31.33, 'average_return': 31.33, 'max_length': 54, 'max_return': 54.0}
220
{'pg loss': 0.005926670506596565, 'value loss': 418758170509312.0, 'entropy': 0.11178681999444962}
{'average_length': 31.33, 'average_return': 31.33, 'max_length': 54, 'max_return': 54.0}
222
{'pg loss': 0.07165917754173279, 'value loss': 747222572466176.0, 'entropy': 0.0414402149617672}
{'average_length': 31.95, 'average_return': 31.95, 'max_length': 74, 'max_return': 74.0}
226
{'pg loss': 0.23648808896541595, 'value loss': 1.782672643661499, 'entropy': 0.07512418925762177}
{'average_length': 32.3, 'average_return': 32.3, 'max_length': 74, 'max_return': 74.0}
229
{'pg loss': -0.12508653104305267, 'value loss': 1229193333440512.0, 'entropy': 0.036701567471027374}
{'average_length': 32.39, 'average_return': 32.39, 'max_length': 74, 'max_return': 74.0}
233
{'pg loss': 0.28738540410995483, 'value loss': 2.188842535018921, 'entropy': 0.12397030740976334}
{'average_length': 32.51, 'average_return': 32.51, 'max_length': 74, 'max_return': 74.0}
238
{'pg loss': 0.02927071414887905, 'value loss': 249802344366080.0, 'entropy': 0.23756888508796692}
{'average_length': 32.03, 'average_return': 32.03, 'max_length': 74, 'max_return': 74.0}
242
{'pg loss': 0.09015308320522308, 'value loss': 717364832239616.0, 'entropy': 0.1577909141778946}
{'average_length': 31.79, 'average_return': 31.79, 'max_length': 74, 'max_return': 74.0}
246
{'pg loss': 0.1984025090932846, 'value loss': 2.382490396499634, 'entropy': 0.08811119943857193}
{'average_length': 31.74, 'average_return': 31.74, 'max_length': 74, 'max_return': 74.0}
250
{'pg loss': -0.02675379253923893, 'value loss': 850290244845568.0, 'entropy': 0.14640116691589355}
{'average_length': 31.84, 'average_return': 31.84, 'max_length': 74, 'max_return': 74.0}
255
{'pg loss': -0.21418042480945587, 'value loss': 1030307692150784.0, 'entropy': 0.15668551623821259}
{'average_length': 31.39, 'average_return': 31.39, 'max_length': 74, 'max_return': 74.0}
260
{'pg loss': 0.23086214065551758, 'value loss': 1.7198827266693115, 'entropy': 0.13765348494052887}
{'average_length': 31.35, 'average_return': 31.35, 'max_length': 74, 'max_return': 74.0}
263
{'pg loss': -0.08235154300928116, 'value loss': 1144160362954752.0, 'entropy': 0.1622401922941208}
{'average_length': 31.12, 'average_return': 31.12, 'max_length': 74, 'max_return': 74.0}
268
{'pg loss': 0.20937035977840424, 'value loss': 2.04659366607666, 'entropy': 0.11896481364965439}
{'average_length': 31.01, 'average_return': 31.01, 'max_length': 74, 'max_return': 74.0}
272
{'pg loss': -0.1316896677017212, 'value loss': 484741451087872.0, 'entropy': 0.12645718455314636}
{'average_length': 30.87, 'average_return': 30.87, 'max_length': 74, 'max_return': 74.0}
276
{'pg loss': -0.30073976516723633, 'value loss': 1088426652729344.0, 'entropy': 0.20048239827156067}
{'average_length': 30.79, 'average_return': 30.79, 'max_length': 74, 'max_return': 74.0}
279
{'pg loss': 0.15129518508911133, 'value loss': 478680279154688.0, 'entropy': 0.17391431331634521}
{'average_length': 30.92, 'average_return': 30.92, 'max_length': 74, 'max_return': 74.0}
283
{'pg loss': 0.13365669548511505, 'value loss': 265605894635520.0, 'entropy': 0.20864635705947876}
{'average_length': 31.08, 'average_return': 31.08, 'max_length': 74, 'max_return': 74.0}
287
{'pg loss': 0.04333789646625519, 'value loss': 404779259920384.0, 'entropy': 0.1658731997013092}
{'average_length': 31.23, 'average_return': 31.23, 'max_length': 74, 'max_return': 74.0}
292
{'pg loss': 0.15595783293247223, 'value loss': 385252996415488.0, 'entropy': 0.17824772000312805}
{'average_length': 30.59, 'average_return': 30.59, 'max_length': 74, 'max_return': 74.0}
296
{'pg loss': 0.2200155258178711, 'value loss': 2.089242935180664, 'entropy': 0.15872341394424438}
{'average_length': 30.54, 'average_return': 30.54, 'max_length': 74, 'max_return': 74.0}
300
{'pg loss': 0.012986738234758377, 'value loss': 758983535099904.0, 'entropy': 0.13644619286060333}
{'average_length': 30.41, 'average_return': 30.41, 'max_length': 74, 'max_return': 74.0}
304
{'pg loss': -0.13398385047912598, 'value loss': 1053296034840576.0, 'entropy': 0.11182797700166702}
{'average_length': 30.46, 'average_return': 30.46, 'max_length': 74, 'max_return': 74.0}
308
{'pg loss': -0.20015618205070496, 'value loss': 515408222224384.0, 'entropy': 0.15258973836898804}
{'average_length': 30.63, 'average_return': 30.63, 'max_length': 74, 'max_return': 74.0}
311
{'pg loss': -0.0010296219261363149, 'value loss': 722889569468416.0, 'entropy': 0.11262282729148865}
{'average_length': 30.86, 'average_return': 30.86, 'max_length': 74, 'max_return': 74.0}
315
{'pg loss': -0.06186959892511368, 'value loss': 445250568978432.0, 'entropy': 0.140251025557518}
{'average_length': 30.91, 'average_return': 30.91, 'max_length': 74, 'max_return': 74.0}
318
{'pg loss': 0.14676105976104736, 'value loss': 387860041564160.0, 'entropy': 0.13580535352230072}
{'average_length': 31.29, 'average_return': 31.29, 'max_length': 74, 'max_return': 74.0}
323
{'pg loss': 0.11750448495149612, 'value loss': 220960229687296.0, 'entropy': 0.14502772688865662}
{'average_length': 30.64, 'average_return': 30.64, 'max_length': 64, 'max_return': 64.0}
327
{'pg loss': -0.009592276997864246, 'value loss': 404779259920384.0, 'entropy': 0.11564470082521439}
{'average_length': 30.41, 'average_return': 30.41, 'max_length': 64, 'max_return': 64.0}
332
{'pg loss': 0.03765237331390381, 'value loss': 461054136025088.0, 'entropy': 0.16410072147846222}
{'average_length': 29.76, 'average_return': 29.76, 'max_length': 64, 'max_return': 64.0}
337
{'pg loss': 0.1714320182800293, 'value loss': 183819047010304.0, 'entropy': 0.14546947181224823}
{'average_length': 29.71, 'average_return': 29.71, 'max_length': 64, 'max_return': 64.0}
341
{'pg loss': -0.19315430521965027, 'value loss': 1025568128630784.0, 'entropy': 0.12489086389541626}
{'average_length': 29.83, 'average_return': 29.83, 'max_length': 64, 'max_return': 64.0}
Traceback (most recent call last):
  File "/home/anthony/PycharmProjects/ppo_kata/main.py", line 128, in <module>
    loss_dict = agent.learn()
  File "/home/anthony/PycharmProjects/ppo_kata/model.py", line 175, in learn
    self.optim.step()
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/optim/adam.py", line 118, in step
    eps=group['eps'])
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/optim/_functional.py", line 94, in adam
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(eps)
KeyboardInterrupt