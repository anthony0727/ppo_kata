<Monitor<TimeLimit<CartPoleEnv<CartPole-v1>>>>
EnvSpec(CartPole-v1)
Box([-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38], [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38], (4,), float32)
Discrete(2)
example transition
OrderedDict([('obs', array([-4.0817757e+00, -2.4718574e+38, -3.0939645e-01,  4.0240118e+37],
      dtype=float32)), ('action', 0), ('reward', 0.0), ('done', False)])
buffer spec
[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')]
Agent(
  (actor): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=2, bias=True)
    (5): Softmax(dim=-1)
  )
  (critic): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
Python 3.7.11 (default, Sep 10 2021, 16:01:34)
Type 'copyright', 'credits' or 'license' for more information
IPython 7.27.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.27.0
Out[1]: ([-0.10913404, -0.04920394,  0.14078955,  0.26945135], 0, 1., 0, 0.18009515, -0.796163)
Out[2]:
Buffer([([-1.37409205e-02, -1.66309997e-02,  2.75590699e-02, -3.46387140e-02], 1, 0., 0, 0.13658321, -0.6161169 ),
        ([-1.40735405e-02,  1.78085133e-01,  2.68662963e-02, -3.18500668e-01], 0, 1., 0, 0.16442414, -0.778456  ),
        ([-1.05118379e-02, -1.74089596e-02,  2.04962827e-02, -1.74676087e-02], 0, 1., 0, 0.13381904, -0.77736074),
        ([-1.08600175e-02, -2.12818757e-01,  2.01469306e-02,  2.81611025e-01], 0, 1., 0, 0.10199385, -0.77443534),
        ([-1.51163926e-02, -4.08222198e-01,  2.57791504e-02,  5.80579519e-01], 1, 1., 0, 0.06899683, -0.621195  ),
        ([-2.32808366e-02, -2.13470802e-01,  3.73907387e-02,  2.96127677e-01], 0, 1., 0, 0.10567115, -0.7757677 ),
        ([-2.75502522e-02, -4.09105301e-01,  4.33132946e-02,  6.00364625e-01], 1, 1., 0, 0.07212447, -0.61989045),
        ([-3.57323587e-02, -2.14615196e-01,  5.53205870e-02,  3.21633220e-01], 0, 1., 0, 0.1086642 , -0.7776346 ),
        ([-4.00246643e-02, -4.10479516e-01,  6.17532507e-02,  6.31236196e-01], 0, 1., 0, 0.07450704, -0.77424157),
        ([-4.82342541e-02, -6.06406271e-01,  7.43779764e-02,  9.42710042e-01], 0, 1., 0, 0.03932683, -0.77109724),
        ([-6.03623763e-02, -8.02447319e-01,  9.32321772e-02,  1.25780559e+00], 1, 1., 0, 0.00410157, -0.62276685),
        ([-7.64113218e-02, -6.08633935e-01,  1.18388288e-01,  9.95718658e-01], 1, 1., 0, 0.04531923, -0.6177858 ),
        ([-8.85840058e-02, -4.15277153e-01,  1.38302654e-01,  7.42438555e-01], 0, 1., 0, 0.08471623, -0.7814235 ),
        ([-9.68895480e-02, -6.12009645e-01,  1.53151438e-01,  1.07525098e+00], 0, 1., 0, 0.04636738, -0.77908057),
        ([-1.09129742e-01, -8.08786690e-01,  1.74656451e-01,  1.41181242e+00], 1, 1., 0, 0.00789062, -0.6152273 ),
        ([-1.25305474e-01, -6.16206467e-01,  2.02892706e-01,  1.17842531e+00], 0, 1., 0, 0.04819559, -0.7845758 ),
        ([-1.37629598e-01, -8.13300431e-01,  2.26461202e-01,  1.52724397e+00], 0, 1., 1, 0.        ,  0.        ),
        ([ 3.77120636e-02,  9.51789133e-03,  7.39213359e-03, -8.01706128e-03], 1, 0., 0, 0.12656745, -0.61512077),
        ([ 3.79024222e-02,  2.04533055e-01,  7.23179197e-03, -2.98358530e-01], 1, 1., 0, 0.1551429 , -0.61418915),
        ([ 4.19930816e-02,  3.99551183e-01,  1.26462127e-03, -5.88751972e-01], 0, 1., 0, 0.18016131, -0.7772819 ),
        ([ 4.99841049e-02,  2.04411536e-01, -1.05104176e-02, -2.95670927e-01], 1, 1., 0, 0.15041777, -0.6146902 ),
        ([ 5.40723354e-02,  3.99681747e-01, -1.64238364e-02, -5.91650069e-01], 1, 1., 0, 0.17601685, -0.61638093),
        ([ 6.20659702e-02,  5.95029712e-01, -2.82568373e-02, -8.89460921e-01], 0, 1., 0, 0.19889885, -0.7714092 ),
        ([ 7.39665627e-02,  4.00302380e-01, -4.60460559e-02, -6.05792880e-01], 0, 1., 0, 0.16960695, -0.77408195),
        ([ 8.19726139e-02,  2.05853522e-01, -5.81619143e-02, -3.27961504e-01], 0, 1., 0, 0.14003791, -0.7743794 ),
        ([ 8.60896856e-02,  1.16057405e-02, -6.47211447e-02, -5.41725010e-02], 0, 1., 0, 0.11018881, -0.7724716 ),
        ([ 8.63218009e-02, -1.82531372e-01, -6.58045933e-02,  2.17408732e-01], 1, 1., 0, 0.08007424, -0.6227682 ),
        ([ 8.26711729e-02,  1.34665491e-02, -6.14564195e-02, -9.52844247e-02], 1, 1., 0, 0.1138294 , -0.6214145 ),
        ([ 8.29405040e-02,  2.09413037e-01, -6.33621067e-02, -4.06706095e-01], 0, 1., 0, 0.1436641 , -0.76975024),
        ([ 8.71287584e-02,  1.52440993e-02, -7.14962259e-02, -1.34653151e-01], 1, 1., 0, 0.11391313, -0.6235108 ),
        ([ 8.74336436e-02,  2.11313441e-01, -7.41892904e-02, -4.49007779e-01], 1, 1., 0, 0.14373685, -0.6243732 ),
        ([ 9.16599110e-02,  4.07402068e-01, -8.31694454e-02, -7.64123261e-01], 0, 1., 0, 0.17034414, -0.76318353),
        ([ 9.98079553e-02,  2.13517979e-01, -9.84519124e-02, -4.98726070e-01], 0, 1., 0, 0.14100525, -0.76330316),
        ([ 1.04078315e-01,  1.99118890e-02, -1.08426437e-01, -2.38621339e-01], 1, 1., 0, 0.11160077, -0.62938964),
        ([ 1.04476549e-01,  2.16402307e-01, -1.13198861e-01, -5.63441098e-01], 0, 1., 0, 0.14179584, -0.7592621 ),
        ([ 1.08804598e-01,  2.30354965e-02, -1.24467686e-01, -3.08456689e-01], 1, 1., 0, 0.11252791, -0.63300645),
        ([ 1.09265305e-01,  2.19690815e-01, -1.30636811e-01, -6.37656748e-01], 0, 1., 0, 0.14275105, -0.7546989 ),
        ([ 1.13659121e-01,  2.66092122e-02, -1.43389955e-01, -3.88800234e-01], 1, 1., 0, 0.11363752, -0.63714194),
        ([ 1.14191309e-01,  2.23444343e-01, -1.51165962e-01, -7.23035157e-01], 1, 1., 0, 0.14394641, -0.6397555 ),
        ([ 1.18660197e-01,  4.20297891e-01, -1.65626660e-01, -1.05922186e+00], 1, 1., 0, 0.17149882, -0.6448426 ),
        ([ 1.27066150e-01,  6.17179930e-01, -1.86811104e-01, -1.39897537e+00], 0, 1., 0, 0.19678311, -0.7359222 ),
        ([ 1.39409751e-01,  4.24806148e-01, -2.14790612e-01, -1.17003882e+00], 1, 1., 1, 0.        ,  0.        ),
        ([ 4.55738567e-02, -2.19500139e-02, -2.53800191e-02, -4.66888845e-02], 1, 0., 0, 0.11994458, -0.62004447),
        ([ 4.51348573e-02,  1.73526496e-01, -2.63137966e-02, -3.47270161e-01], 0, 1., 0, 0.14930585, -0.7726114 ),
        ([ 4.86053862e-02, -2.12114751e-02, -3.32591981e-02, -6.29996732e-02], 0, 1., 0, 0.11916023, -0.7709687 ),
        ([ 4.81811576e-02, -2.15841174e-01, -3.45191918e-02,  2.19007015e-01], 0, 1., 0, 0.08842607, -0.7675761 ),
        ([ 4.38643321e-02, -4.10453111e-01, -3.01390532e-02,  5.00604391e-01], 0, 1., 0, 0.05721634, -0.76329577),
        ([ 3.56552713e-02, -6.05137527e-01, -2.01269649e-02,  7.83638835e-01], 1, 1., 0, 0.02588462, -0.6313232 ),
        ([ 2.35525202e-02, -4.09744859e-01, -4.45418805e-03,  4.84692276e-01], 0, 1., 0, 0.06561434, -0.76342845),
        ([ 1.53576238e-02, -6.04803681e-01,  5.23965759e-03,  7.75968075e-01], 1, 1., 0, 0.03327823, -0.6309157 ),
        ([ 3.26155056e-03, -4.09754157e-01,  2.07590181e-02,  4.84938294e-01], 0, 1., 0, 0.07270516, -0.76436687),
        ([-4.93353279e-03, -6.05162799e-01,  3.04577835e-02,  7.84090817e-01], 1, 1., 0, 0.03939467, -0.62981206),
        ([-1.70367900e-02, -4.10472363e-01,  4.61396016e-02,  5.01143754e-01], 1, 1., 0, 0.07858355, -0.6251678 ),
        ([-2.52462365e-02, -2.16030136e-01,  5.61624765e-02,  2.23351091e-01], 1, 1., 0, 0.11408097, -0.62050486),
        ([-2.95668393e-02, -2.17540078e-02,  6.06294982e-02, -5.11005521e-02], 1, 1., 0, 0.14514172, -0.61668414),
        ([-3.00019197e-02,  1.72448546e-01,  5.96074872e-02, -3.24054986e-01], 1, 1., 0, 0.17192547, -0.6145224 ),
        ([-2.65529491e-02,  3.66673321e-01,  5.31263873e-02, -5.97360492e-01], 1, 1., 0, 0.19517635, -0.6145708 ),
        ([-1.92194823e-02,  5.61013162e-01,  4.11791764e-02, -8.72847199e-01], 0, 1., 0, 0.21577978, -0.7755195 ),
        ([-7.99921807e-03,  3.65356207e-01,  2.37222333e-02, -5.67507267e-01], 1, 1., 0, 0.18672703, -0.6140087 ),
        ([-6.92094094e-04,  5.60137510e-01,  1.23720877e-02, -8.52623343e-01], 1, 1., 0, 0.20843859, -0.61697936),
        ([ 1.05106561e-02,  7.55088627e-01, -4.68037929e-03, -1.14139032e+00], 1, 1., 0, 0.22809725, -0.6223544 ),
        ([ 2.56124288e-02,  9.50271428e-01, -2.75081862e-02, -1.43553734e+00], 0, 1., 0, 0.24613596, -0.7606862 ),
        ([ 4.46178578e-02,  7.55499303e-01, -5.62189333e-02, -1.15157604e+00], 0, 1., 0, 0.2178875 , -0.76629823),
        ([ 5.97278439e-02,  5.61154068e-01, -7.92504549e-02, -8.77038479e-01], 1, 1., 0, 0.1891223 , -0.6218888 ),
        ([ 7.09509254e-02,  7.57258534e-01, -9.67912227e-02, -1.19354713e+00], 0, 1., 0, 0.21163806, -0.76170653),
        ([ 8.60960931e-02,  5.63514113e-01, -1.20662168e-01, -9.32703018e-01], 1, 1., 0, 0.18295123, -0.6265674 ),
        ([ 9.73663777e-02,  7.60039270e-01, -1.39316231e-01, -1.26073611e+00], 0, 1., 0, 0.20657356, -0.75554186),
        ([ 1.12567164e-01,  5.66946685e-01, -1.64530948e-01, -1.01473010e+00], 1, 1., 0, 0.17807655, -0.63270545),
        ([ 1.23906098e-01,  7.63834894e-01, -1.84825554e-01, -1.35422814e+00], 1, 1., 0, 0.20276275, -0.6412565 ),
        ([ 1.39182791e-01,  9.60732162e-01, -2.11910114e-01, -1.69857371e+00], 0, 1., 1, 0.        ,  0.        ),
        ([ 1.66358221e-02, -2.84206029e-02, -4.08766717e-02,  4.11495306e-02], 1, 0., 0, 0.11492362, -0.61476475),
        ([ 1.60674099e-02,  1.67262942e-01, -4.00536843e-02, -2.64144987e-01], 1, 1., 0, 0.14545089, -0.61409736),
        ([ 1.94126703e-02,  3.62933040e-01, -4.53365818e-02, -5.69187343e-01], 0, 1., 0, 0.17221917, -0.77702785),
        ([ 2.66713295e-02,  1.68475285e-01, -5.67203313e-02, -2.91124851e-01], 1, 1., 0, 0.14284097, -0.6159679 ),
        ([ 3.00408360e-02,  3.64358187e-01, -6.25428259e-02, -6.01143539e-01], 0, 1., 0, 0.1699346 , -0.77437586),
        ([ 3.73280011e-02,  1.70164332e-01, -7.45656937e-02, -3.28797847e-01], 0, 1., 0, 0.14067104, -0.77395576),
        ([ 4.07312848e-02, -2.38212794e-02, -8.11416507e-02, -6.05299957e-02], 0, 1., 0, 0.11111487, -0.7713452 ),
        ([ 4.02548611e-02, -2.17691734e-01, -8.23522508e-02,  2.05489412e-01], 1, 1., 0, 0.08127836, -0.6243068 ),
        ([ 3.59010249e-02, -2.14945972e-02, -7.82424659e-02, -1.11993127e-01], 0, 1., 0, 0.11558791, -0.76886785),
        ([ 3.54711339e-02, -2.15413272e-01, -8.04823264e-02,  1.55015171e-01], 0, 1., 0, 0.0857315 , -0.7647394 ),
        ([ 3.11628692e-02, -4.09296155e-01, -7.73820281e-02,  4.21261847e-01], 1, 1., 0, 0.05568857, -0.6307794 ),
        ([ 2.29769461e-02, -2.13168010e-01, -6.89567849e-02,  1.05222367e-01], 0, 1., 0, 0.09290585, -0.7628671 ),
        ([ 1.87135842e-02, -4.07237470e-01, -6.68523386e-02,  3.75377506e-01], 0, 1., 0, 0.06255917, -0.7579696 ),
        ([ 1.05688348e-02, -6.01349354e-01, -5.93447909e-02,  6.46254897e-01], 1, 1., 0, 0.03216345, -0.6367217 ),
        ([-1.45815127e-03, -4.05452877e-01, -4.64196913e-02,  3.35490376e-01], 0, 1., 0, 0.07181238, -0.7569753 ),
        ([-9.56720859e-03, -5.99884510e-01, -3.97098847e-02,  6.13181174e-01], 1, 1., 0, 0.04065422, -0.63738596),
        ([-2.15648990e-02, -4.04230803e-01, -2.74462607e-02,  3.08260322e-01], 1, 1., 0, 0.07985947, -0.63346446),
        ([-2.96495147e-02, -2.08728731e-01, -2.12810542e-02,  7.04950560e-03], 1, 1., 0, 0.11511043, -0.6298498 ),
        ([-3.38240899e-02, -1.33081479e-02, -2.11400632e-02, -2.92271167e-01], 0, 1., 0, 0.14594561, -0.76332515),
        ([-3.40902507e-02, -2.08122402e-01, -2.69854870e-02, -6.32978370e-03], 1, 1., 0, 0.11555187, -0.6302142 ),
        ([-3.82527001e-02, -1.26240430e-02, -2.71120816e-02, -3.07403326e-01], 0, 1., 0, 0.14639837, -0.7627964 ),
        ([-3.85051817e-02, -2.07349390e-01, -3.32601480e-02, -2.33926307e-02], 1, 1., 0, 0.11613665, -0.63074243),
        ([-4.26521674e-02, -1.17666312e-02, -3.37279998e-02, -3.26381177e-01], 1, 1., 0, 0.14697483, -0.62867725),
        ([-4.28875014e-02,  1.83818877e-01, -4.02556248e-02, -6.29506767e-01], 0, 1., 0, 0.17388566, -0.7619004 ),
        ([-3.92111242e-02, -1.07188709e-02, -5.28457612e-02, -3.49768490e-01], 1, 1., 0, 0.14468136, -0.6299198 ),
        ([-3.94254997e-02,  1.85113266e-01, -5.98411299e-02, -6.58636034e-01], 1, 1., 0, 0.17197579, -0.6304307 ),
        ([-3.57232355e-02,  3.81014794e-01, -7.30138496e-02, -9.69545186e-01], 1, 1., 0, 0.19625266, -0.63350356),
        ([-2.81029399e-02,  5.77036917e-01, -9.24047530e-02, -1.28424191e+00], 0, 1., 0, 0.2182603 , -0.7503737 ),
        ([-1.65622011e-02,  3.83204967e-01, -1.18089594e-01, -1.02186275e+00], 0, 1., 0, 0.1903387 , -0.752327  ),
        ([-8.89810175e-03,  1.89837247e-01, -1.38526857e-01, -7.68468976e-01], 0, 1., 0, 0.16215765, -0.7520641 ),
        ([-5.10135666e-03, -3.13366763e-03, -1.53896227e-01, -5.22382200e-01], 1, 1., 0, 0.13386548, -0.63973856),
        ([-5.16403001e-03,  1.93781316e-01, -1.64343879e-01, -8.59330893e-01], 0, 1., 0, 0.16311327, -0.7468573 ),
        ([-1.28840376e-03,  1.23333745e-03, -1.81530491e-01, -6.22500420e-01], 0, 1., 0, 0.13515195, -0.7441917 ),
        ([-1.26373698e-03, -1.90951943e-01, -1.93980500e-01, -3.92036647e-01], 1, 1., 0, 0.10728677, -0.6488438 ),
        ([-5.08277584e-03,  6.31744508e-03, -2.01821238e-01, -7.39064217e-01], 0, 1., 0, 0.13979957, -0.73854834),
        ([-4.95642703e-03, -1.85530812e-01, -2.16602519e-01, -5.16066194e-01], 0, 1., 1, 0.        ,  0.        ),
        ([-2.24968493e-02,  3.89546417e-02,  3.07897478e-02, -1.10802995e-02], 1, 0., 0, 0.14024502, -0.6098801 ),
        ([-2.17177570e-02,  2.33621806e-01,  3.05681415e-02, -2.93891907e-01], 1, 1., 0, 0.16782872, -0.6085438 ),
        ([-1.70453209e-02,  4.28294897e-01,  2.46903040e-02, -5.76779485e-01], 1, 1., 0, 0.19182317, -0.6094992 ),
        ([-8.47942196e-03,  6.23062253e-01,  1.31547134e-02, -8.61583233e-01], 1, 1., 0, 0.21311653, -0.61293167),
        ([ 3.98182217e-03,  8.18002582e-01, -4.07695118e-03, -1.15010107e+00], 1, 1., 0, 0.23240052, -0.61874765),
        ([ 2.03418750e-02,  1.01317751e+00, -2.70789731e-02, -1.44405973e+00], 1, 1., 0, 0.2500764 , -0.6266844 ),
        ([ 4.06054258e-02,  1.20862210e+00, -5.59601672e-02, -1.74507928e+00], 1, 1., 0, 0.26633015, -0.63639027),
        ([ 6.47778660e-02,  1.40433395e+00, -9.08617526e-02, -2.05463123e+00], 0, 1., 0, 0.28125352, -0.74101865),
        ([ 9.28645432e-02,  1.21025109e+00, -1.31954372e-01, -1.79138458e+00], 0, 1., 0, 0.25504664, -0.7467817 ),
        ([ 1.17069565e-01,  1.01683283e+00, -1.67782068e-01, -1.54246128e+00], 1, 1., 0, 0.22791156, -0.63839275),
        ([ 1.37406230e-01,  1.21352708e+00, -1.98631287e-01, -1.88245642e+00], 0, 1., 0, 0.24786921, -0.7381508 ),
        ([ 1.61676764e-01,  1.02104568e+00, -2.36280426e-01, -1.65742564e+00], 1, 1., 1, 0.        ,  0.        ),
        ([-4.24745716e-02, -3.66768241e-02,  3.71735357e-02, -9.38917790e-03], 0, 0., 0, 0.13908496, -0.7777101 ),
        ([-4.32081111e-02, -2.32311636e-01,  3.69857512e-02,  2.94786811e-01], 0, 1., 0, 0.10686637, -0.7747953 ),
        ([-4.78543416e-02, -4.27940816e-01,  4.28814888e-02,  5.98901212e-01], 0, 1., 0, 0.07320764, -0.77112174),
        ([-5.64131588e-02, -6.23635709e-01,  5.48595116e-02,  9.04776990e-01], 0, 1., 0, 0.03862542, -0.76772684),
        ([-6.88858703e-02, -8.19455981e-01,  7.29550496e-02,  1.21418607e+00], 1, 1., 0, 0.00401011, -0.6258571 ),
        ([-8.52749944e-02, -6.25347197e-01,  9.72387716e-02,  9.45227265e-01], 1, 1., 0, 0.04557165, -0.6210958 ),
        ([-9.77819338e-02, -4.31659967e-01,  1.16143323e-01,  6.84612036e-01], 1, 1., 0, 0.08520304, -0.6155355 ),
        ([-1.06415138e-01, -2.38325730e-01,  1.29835561e-01,  4.30633843e-01], 1, 1., 0, 0.12129471, -0.6096543 ),
        ([-1.11181647e-01, -4.52583395e-02,  1.38448238e-01,  1.81534767e-01], 1, 1., 0, 0.15295257, -0.60414547),
        ([-1.12086818e-01,  1.47638947e-01,  1.42078936e-01, -6.44686446e-02], 0, 1., 0, 0.18009515, -0.796163  ),
        ([-1.09134041e-01, -4.92039360e-02,  1.40789554e-01,  2.69451350e-01], 0, 1., 0, 0.18009515, -0.796163  )],
       dtype=[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')])
Traceback (most recent call last):
  File "/home/anthony/PycharmProjects/ppo_kata/main.py", line 128, in <module>
    loss_dict = agent.learn()
  File "/home/anthony/PycharmProjects/ppo_kata/model.py", line 132, in learn
    advs = gae(buffer['reward'], self.buffer['value'], self.buffer['done'])
  File "/home/anthony/PycharmProjects/ppo_kata/buffer.py", line 69, in __array_finalize__
    def __array_finalize__(self, obj):
KeyboardInterrupt