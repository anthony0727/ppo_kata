<Monitor<TimeLimit<CartPoleEnv<CartPole-v1>>>>
EnvSpec(CartPole-v1)
Box([-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38], [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38], (4,), float32)
Discrete(2)
example transition
OrderedDict([('obs', array([ 2.1768053e+00, -1.2017656e+38,  1.1810489e-01, -3.1354293e+38],
      dtype=float32)), ('action', 1), ('reward', 0.0), ('done', False)])
buffer spec
[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')]
Agent(
  (actor): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=2, bias=True)
    (5): Softmax(dim=-1)
  )
  (critic): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
4
{'pg loss': 0.10771382600069046, 'value loss': 5.126781463623047, 'entropy': 0.690043032169342}
{'average_length': 31.0, 'average_return': 31.0, 'max_length': 57, 'max_return': 57.0}
Python 3.7.11 (default, Sep 10 2021, 16:01:34)
Type 'copyright', 'credits' or 'license' for more information
IPython 7.27.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.27.0
Out[2]:
Buffer([([ 2.84239706e-02,  4.41347901e-03, -2.03809701e-02,  1.62023902e-02], 0, 0., 0, -0.04899721, -0.6918252 ),
        ([ 2.85122395e-02, -1.90410346e-01, -2.00569220e-02,  3.02385837e-01], 1, 1., 0,  0.00875168, -0.73710763),
        ([ 2.47040335e-02,  4.99163521e-03, -1.40092047e-02,  3.44548677e-03], 1, 1., 0, -0.04968183, -0.6936381 ),
        ([ 2.48038657e-02,  2.00311661e-01, -1.39402952e-02, -2.93624371e-01], 0, 1., 0, -0.10923038, -0.7356419 ),
        ([ 2.88100988e-02,  5.39121358e-03, -1.98127832e-02, -5.37042599e-03], 0, 1., 0, -0.05067078, -0.69414014),
        ([ 2.89179236e-02, -1.89441070e-01, -1.99201908e-02,  2.80996054e-01], 0, 1., 0,  0.00726217, -0.6532098 ),
        ([ 2.51291022e-02, -3.84273291e-01, -1.43002700e-02,  5.67330241e-01], 1, 1., 0,  0.06061321, -0.7777483 ),
        ([ 1.74436364e-02, -1.88953698e-01, -2.95366417e-03,  2.70176679e-01], 1, 1., 0,  0.00748773, -0.7349915 ),
        ([ 1.36645623e-02,  6.21028012e-03,  2.44986964e-03, -2.34363712e-02], 1, 1., 0, -0.05105615, -0.6920895 ),
        ([ 1.37887681e-02,  2.01297015e-01,  1.98114221e-03, -3.15345317e-01], 0, 1., 0, -0.11036871, -0.7365835 ),
        ([ 1.78147089e-02,  6.14689710e-03, -4.32576425e-03, -2.20382772e-02], 1, 1., 0, -0.05129858, -0.69162387),
        ([ 1.79376472e-02,  2.01330617e-01, -4.76652989e-03, -3.16082895e-01], 1, 1., 0, -0.11072485, -0.65083003),
        ([ 2.19642594e-02,  3.96520138e-01, -1.10881878e-02, -6.10265195e-01], 0, 1., 0, -0.16613674, -0.7786533 ),
        ([ 2.98946612e-02,  2.01554924e-01, -2.32934915e-02, -3.21095198e-01], 0, 1., 0, -0.11189845, -0.7396943 ),
        ([ 3.39257605e-02,  6.77229790e-03, -2.97153965e-02, -3.58482040e-02], 0, 1., 0, -0.05371949, -0.69852585),
        ([ 3.40612046e-02, -1.87911198e-01, -3.04323602e-02,  2.47313082e-01], 0, 1., 0,  0.00411839, -0.6576793 ),
        ([ 3.03029809e-02, -3.82585615e-01, -2.54860986e-02,  5.30243754e-01], 0, 1., 0,  0.05767624, -0.6194464 ),
        ([ 2.26512700e-02, -5.77339947e-01, -1.48812234e-02,  8.14788282e-01], 1, 1., 0,  0.10433587, -0.81385994),
        ([ 1.11044701e-02, -3.82017404e-01,  1.41454267e-03,  5.17462015e-01], 0, 1., 0,  0.05873759, -0.6187523 ),
        ([ 3.46412230e-03, -5.77159226e-01,  1.17637832e-02,  8.10590327e-01], 1, 1., 0,  0.10616995, -0.8154898 ),
        ([-8.07906315e-03, -3.82200420e-01,  2.79755890e-02,  5.21630824e-01], 1, 1., 0,  0.06071727, -0.7761147 ),
        ([-1.57230720e-02, -1.87483191e-01,  3.84082049e-02,  2.37893015e-01], 0, 1., 0,  0.00729136, -0.6533132 ),
        ([-1.94727350e-02, -3.83132219e-01,  4.31660675e-02,  5.42439342e-01], 0, 1., 0,  0.06288709, -0.61364025),
        ([-2.71353796e-02, -5.78833401e-01,  5.40148541e-02,  8.48404586e-01], 0, 1., 0,  0.11071435, -0.5788745 ),
        ([-3.87120470e-02, -7.74648845e-01,  7.09829405e-02,  1.15757191e+00], 1, 1., 0,  0.14992556, -0.86039865),
        ([-5.42050228e-02, -5.80520213e-01,  9.41343829e-02,  8.87963772e-01], 0, 1., 0,  0.1151583 , -0.5737145 ),
        ([-6.58154264e-02, -7.76785016e-01,  1.11893661e-01,  1.20869219e+00], 1, 1., 0,  0.1542052 , -0.8668809 ),
        ([-8.13511312e-02, -5.83271801e-01,  1.36067510e-01,  9.53065813e-01], 1, 1., 0,  0.12059543, -0.8375747 ),
        ([-9.30165648e-02, -3.90217006e-01,  1.55128822e-01,  7.06040680e-01], 1, 1., 0,  0.07937934, -0.8052064 ),
        ([-1.00820906e-01, -1.97545707e-01,  1.69249639e-01,  4.65929389e-01], 1, 1., 0,  0.03137464, -0.7708942 ),
        ([-1.04771815e-01, -5.16866380e-03,  1.78568214e-01,  2.31009200e-01], 1, 1., 0, -0.02145691, -0.73587716),
        ([-1.04875192e-01,  1.87012061e-01,  1.83188409e-01, -4.57589631e-04], 1, 1., 0, -0.07620275, -0.70141584),
        ([-1.01134948e-01,  3.79098803e-01,  1.83179259e-01, -2.30209991e-01], 1, 1., 0, -0.12957147, -0.66863894),
        ([-9.35529768e-02,  5.71195066e-01,  1.78575054e-01, -4.59979624e-01], 0, 1., 0, -0.17861137, -0.7510716 ),
        ([-8.21290761e-02,  3.74058008e-01,  1.69375464e-01, -1.16753876e-01], 1, 1., 0, -0.12053884, -0.67939717),
        ([-7.46479109e-02,  5.66399395e-01,  1.67040378e-01, -3.51578802e-01], 0, 1., 0, -0.17073083, -0.7404974 ),
        ([-6.33199289e-02,  3.69344771e-01,  1.60008803e-01, -1.12292310e-02], 1, 1., 0, -0.11168059, -0.69002616),
        ([-5.59330285e-02,  5.61853409e-01,  1.59784228e-01, -2.49461338e-01], 1, 1., 0, -0.16265479, -0.6576743 ),
        ([-4.46959622e-02,  7.54375637e-01,  1.54794991e-01, -4.87789184e-01], 0, 1., 0, -0.20806217, -0.76276875),
        ([-2.96084490e-02,  5.57447314e-01,  1.45039216e-01, -1.50600448e-01], 1, 1., 0, -0.15469402, -0.66671693),
        ([-1.84595026e-02,  7.50226796e-01,  1.42027199e-01, -3.94241273e-01], 0, 1., 0, -0.20130801, -0.75388515),
        ([-3.45496694e-03,  5.53405285e-01,  1.34142384e-01, -6.03658855e-02], 1, 1., 0, -0.14692113, -0.6755184 ),
        ([ 7.61313830e-03,  7.46374309e-01,  1.32935062e-01, -3.07899475e-01], 0, 1., 0, -0.19444594, -0.74514323),
        ([ 2.25406252e-02,  5.49633443e-01,  1.26777068e-01,  2.35760473e-02], 1, 1., 0, -0.13926306, -0.6842064 ),
        ([ 3.35332938e-02,  7.42730856e-01,  1.27248585e-01, -2.26572812e-01], 1, 1., 0, -0.18744218, -0.6516642 ),
        ([ 4.83879112e-02,  9.35826302e-01,  1.22717135e-01, -4.76563990e-01], 1, 1., 0, -0.22927809, -0.62199676),
        ([ 6.71044365e-02,  1.12902129e+00,  1.13185853e-01, -7.28188694e-01], 1, 1., 0, -0.2636453 , -0.5956349 ),
        ([ 8.96848589e-02,  1.32241166e+00,  9.86220837e-02, -9.83212590e-01], 1, 1., 0, -0.2905614 , -0.5726997 ),
        ([ 1.16133094e-01,  1.51608384e+00,  7.89578333e-02, -1.24336135e+00], 0, 1., 0, -0.31082284, -0.85606   ),
        ([ 1.46454766e-01,  1.32004249e+00,  5.40906042e-02, -9.27025855e-01], 1, 1., 0, -0.287667  , -0.5732069 ),
        ([ 1.72855616e-01,  1.51439393e+00,  3.55500877e-02, -1.20223188e+00], 1, 1., 0, -0.30877227, -0.5524999 ),
        ([ 2.03143507e-01,  1.70903862e+00,  1.15054501e-02, -1.48356485e+00], 1, 1., 0, -0.32393193, -0.53527576),
        ([ 2.37324268e-01,  1.90401840e+00, -1.81658454e-02, -1.77263260e+00], 1, 1., 0, -0.33442003, -0.5211248 ),
        ([ 2.75404632e-01,  2.09934044e+00, -5.36184981e-02, -2.07090783e+00], 1, 1., 0, -0.3413466 , -0.50959224),
        ([ 3.17391455e-01,  2.29496455e+00, -9.50366557e-02, -2.37967849e+00], 1, 1., 0, -0.34559417, -0.50023204),
        ([ 3.63290727e-01,  2.49078798e+00, -1.42630219e-01, -2.69998693e+00], 0, 1., 0, -0.3478494 , -0.94420666),
        ([ 4.13106501e-01,  2.29695940e+00, -1.96629956e-01, -2.45398784e+00], 0, 1., 0, -0.34386897, -0.941513  ),
        ([ 4.59045678e-01,  2.10397649e+00, -2.45709717e-01, -2.22752881e+00], 1, 1., 1,  0.        ,  0.        ),
        ([ 4.19325791e-02, -4.31351131e-03,  5.81266219e-03,  3.37504074e-02], 1, 0., 0, -0.04294803, -0.7009413 ),
        ([ 4.18463126e-02,  1.90724611e-01,  6.48767035e-03, -2.57092923e-01], 0, 1., 0, -0.10198332, -0.72741413),
        ([ 4.56608012e-02, -4.48936783e-03,  1.34581234e-03,  3.76292467e-02], 0, 1., 0, -0.04281941, -0.6853328 ),
        ([ 4.55710143e-02, -1.99630588e-01,  2.09839735e-03,  3.30736488e-01], 0, 1., 0,  0.01517119, -0.64425784),
        ([ 4.15784046e-02, -3.94782364e-01,  8.71312711e-03,  6.24080420e-01], 1, 1., 0,  0.06799702, -0.7880173 ),
        ([ 3.36827561e-02, -1.99783131e-01,  2.11947355e-02,  3.34154308e-01], 0, 1., 0,  0.01660818, -0.6423821 ),
        ([ 2.96870936e-02, -3.95200223e-01,  2.78778207e-02,  6.33444905e-01], 0, 1., 0,  0.06986299, -0.60434896),
        ([ 2.17830893e-02, -5.90699732e-01,  4.05467190e-02,  9.34775233e-01], 0, 1., 0,  0.11534207, -0.57135004),
        ([ 9.96909477e-03, -7.86344469e-01,  5.92422225e-02,  1.23991859e+00], 0, 1., 0,  0.15262163, -0.54404664),
        ([-5.75779472e-03, -9.82175052e-01,  8.40405971e-02,  1.55055618e+00], 0, 1., 0,  0.18269727, -0.5224121 ),
        ([-2.54012961e-02, -1.17819858e+00,  1.15051717e-01,  1.86823261e+00], 0, 1., 0,  0.2071487 , -0.5059861 ),
        ([-4.89652678e-02, -1.37437594e+00,  1.52416378e-01,  2.19430399e+00], 1, 1., 0,  0.22752017, -0.9419263 ),
        ([-7.64527842e-02, -1.18101919e+00,  1.96302444e-01,  1.95226812e+00], 0, 1., 0,  0.2142379 , -0.5015212 ),
        ([-1.00073166e-01, -1.37761211e+00,  2.35347807e-01,  2.29883695e+00], 1, 1., 1,  0.        ,  0.        ),
        ([-2.74766814e-02, -4.94550988e-02, -2.80563813e-02,  2.55265795e-02], 1, 0., 0, -0.04146208, -0.6941793 ),
        ([-2.84657832e-02,  1.46057740e-01, -2.75458507e-02, -2.75874734e-01], 0, 1., 0, -0.10208849, -0.73598516),
        ([-2.55446285e-02, -4.86606061e-02, -3.30633447e-02,  7.99450278e-03], 1, 1., 0, -0.04322181, -0.69167805),
        ([-2.65178401e-02,  1.46919534e-01, -3.29034552e-02, -2.94934213e-01], 0, 1., 0, -0.10398386, -0.7387726 ),
        ([-2.35794485e-02, -4.77182530e-02, -3.88021395e-02, -1.28074409e-02], 0, 1., 0, -0.04531444, -0.69759583),
        ([-2.45338138e-02, -2.42262870e-01, -3.90582904e-02,  2.67384857e-01], 1, 1., 0,  0.01238108, -0.7306945 ),
        ([-2.93790717e-02, -4.66058850e-02, -3.37105915e-02, -3.73569950e-02], 0, 1., 0, -0.04719909, -0.70008165),
        ([-3.03111896e-02, -2.41228610e-01, -3.44577320e-02,  2.44502202e-01], 1, 1., 0,  0.01087783, -0.7283225 ),
        ([-3.51357609e-02, -4.56318744e-02, -2.95676868e-02, -5.88473156e-02], 0, 1., 0, -0.04892685, -0.7023463 ),
        ([-3.60483974e-02, -2.40317672e-01, -3.07446346e-02,  2.24362105e-01], 0, 1., 0,  0.00947135, -0.66120315),
        ([-4.08547521e-02, -4.34987038e-01, -2.62573920e-02,  5.07190645e-01], 0, 1., 0,  0.06332   , -0.6226381 ),
        ([-4.95544933e-02, -6.29729331e-01, -1.61135793e-02,  7.91484654e-01], 1, 1., 0,  0.11002207, -0.81027836),
        ([-6.21490814e-02, -4.34389919e-01, -2.83885369e-04,  4.93776351e-01], 0, 1., 0,  0.06415535, -0.6222098 ),
        ([-7.08368793e-02, -6.29507840e-01,  9.59164184e-03,  7.86369801e-01], 0, 1., 0,  0.11162528, -0.5872604 ),
        ([-8.34270343e-02, -8.24760258e-01,  2.53190380e-02,  1.08205485e+00], 1, 1., 0,  0.1507434 , -0.84990036),
        ([-9.99222398e-02, -6.29981458e-01,  4.69601341e-02,  7.97423303e-01], 0, 1., 0,  0.11468073, -0.5842591 ),
        ([-1.12521872e-01, -8.25715244e-01,  6.29085973e-02,  1.10450149e+00], 1, 1., 0,  0.15408495, -0.8541504 ),
        ([-1.29036173e-01, -6.31474435e-01,  8.49986300e-02,  8.32199574e-01], 1, 1., 0,  0.11866285, -0.82134795),
        ([-1.41665667e-01, -4.37610537e-01,  1.01642616e-01,  5.67413032e-01], 0, 1., 0,  0.07472293, -0.6088756 ),
        ([-1.50417879e-01, -6.34000361e-01,  1.12990879e-01,  8.90308857e-01], 0, 1., 0,  0.12276239, -0.5739115 ),
        ([-1.63097888e-01, -8.30459058e-01,  1.30797058e-01,  1.21626639e+00], 0, 1., 0,  0.16142577, -0.5453409 ),
        ([-1.79707065e-01, -1.02700269e+00,  1.55122384e-01,  1.54690838e+00], 1, 1., 0,  0.19192198, -0.8982307 ),
        ([-2.00247109e-01, -8.34046185e-01,  1.86060548e-01,  1.30637228e+00], 0, 1., 0,  0.16724965, -0.5385934 ),
        ([-2.16928035e-01, -1.03097427e+00,  2.12188005e-01,  1.65105283e+00], 0, 1., 1,  0.        ,  0.        ),
        ([ 2.32331231e-02,  2.01637596e-02,  1.72633510e-02, -4.80003953e-02], 1, 0., 0, -0.05375871, -0.69108784),
        ([ 2.36363970e-02,  2.15033963e-01,  1.63033437e-02, -3.35186988e-01], 1, 1., 0, -0.11256388, -0.6512015 ),
        ([ 2.79370770e-02,  4.09920156e-01,  9.59960371e-03, -6.22684419e-01], 0, 1., 0, -0.16711116, -0.7772671 ),
        ([ 3.61354798e-02,  2.14665473e-01, -2.85408483e-03, -3.26993674e-01], 0, 1., 0, -0.11268983, -0.737871  ),
        ([ 4.04287875e-02,  1.95842739e-02, -9.39395837e-03, -3.52121666e-02], 1, 1., 0, -0.05404648, -0.690116  ),
        ([ 4.08204757e-02,  2.14839667e-01, -1.00982012e-02, -3.30844104e-01], 0, 1., 0, -0.11329539, -0.7390043 ),
        ([ 4.51172665e-02,  1.98629070e-02, -1.67150833e-02, -4.13627103e-02], 0, 1., 0, -0.05491398, -0.6975384 ),
        ([ 4.55145277e-02, -1.75015420e-01, -1.75423380e-02,  2.45999932e-01], 0, 1., 0,  0.00326727, -0.656375  ),
        ([ 4.20142189e-02, -3.69882494e-01, -1.26223397e-02,  5.33098400e-01], 0, 1., 0,  0.05717126, -0.61788243),
        ([ 3.46165672e-02, -5.64824641e-01, -1.96037185e-03,  8.21777463e-01], 0, 1., 0,  0.1040875 , -0.5837344 ),
        ([ 2.33200751e-02, -7.59919703e-01,  1.44751780e-02,  1.11384320e+00], 1, 1., 0,  0.1431014 , -0.853754  ),
        ([ 8.12168047e-03, -5.64990819e-01,  3.67520414e-02,  8.25735986e-01], 1, 1., 0,  0.10716603, -0.8193967 ),
        ([-3.17813572e-03, -3.70390236e-01,  5.32667600e-02,  5.44834912e-01], 1, 1., 0,  0.06226268, -0.7812186 ),
        ([-1.05859404e-02, -1.76055670e-01,  6.41634613e-02,  2.69399524e-01], 1, 1., 0,  0.0096951 , -0.7409874 ),
        ([-1.41070541e-02,  1.80947464e-02,  6.95514530e-02, -2.37570866e-03], 1, 1., 0, -0.04755935, -0.70071304),
        ([-1.37451589e-02,  2.12153867e-01,  6.95039332e-02, -2.72328973e-01], 1, 1., 0, -0.10537355, -0.66236526),
        ([-9.50208213e-03,  4.06218767e-01,  6.40573576e-02, -5.42305768e-01], 1, 1., 0, -0.15954548, -0.627523  ),
        ([-1.37770630e-03,  6.00384712e-01,  5.32112420e-02, -8.14137340e-01], 1, 1., 0, -0.20687869, -0.5971296 ),
        ([ 1.06299883e-02,  7.94739127e-01,  3.69284935e-02, -1.08961964e+00], 0, 1., 0, -0.24576497, -0.831694  ),
        ([ 2.65247710e-02,  5.99150360e-01,  1.51361004e-02, -7.85581946e-01], 0, 1., 0, -0.20630366, -0.8004637 ),
        ([ 3.85077782e-02,  4.03823733e-01, -5.75539307e-04, -4.88175780e-01], 1, 1., 0, -0.15757802, -0.6271056 ),
        ([ 4.65842523e-02,  5.98953784e-01, -1.03390543e-02, -7.81040013e-01], 0, 1., 0, -0.20658597, -0.80246955),
        ([ 5.85633293e-02,  4.03975487e-01, -2.59598549e-02, -4.91627812e-01], 0, 1., 0, -0.15845379, -0.76656795),
        ([ 6.66428357e-02,  2.09229141e-01, -3.57924104e-02, -2.07238078e-01], 1, 1., 0, -0.10379155, -0.6603477 ),
        ([ 7.08274171e-02,  4.04844135e-01, -3.99371721e-02, -5.10993361e-01], 0, 1., 0, -0.16010174, -0.76984453),
        ([ 7.89243057e-02,  2.10306868e-01, -5.01570404e-02, -2.31158540e-01], 0, 1., 0, -0.10610733, -0.73092777),
        ([ 8.31304416e-02,  1.59361660e-02, -5.47802113e-02,  4.52908538e-02], 1, 1., 0, -0.04907075, -0.6958241 ),
        ([ 8.34491625e-02,  2.11799100e-01, -5.38743958e-02, -2.64160156e-01], 0, 1., 0, -0.10876737, -0.7348674 ),
        ([ 8.76851454e-02,  1.74858551e-02, -5.91575988e-02,  1.10554043e-02], 0, 1., 0, -0.05191196, -0.6945756 ),
        ([ 8.80348608e-02, -1.76739991e-01, -5.89364916e-02,  2.84502357e-01], 0, 1., 0,  0.00431967, -0.6548407 ),
        ([ 8.45000595e-02, -3.70974004e-01, -5.32464422e-02,  5.58030188e-01], 1, 1., 0,  0.05637772, -0.77474684),
        ([ 7.70805851e-02, -1.75146624e-01, -4.20858376e-02,  2.49058381e-01], 0, 1., 0,  0.0028083 , -0.6571924 ),
        ([ 7.35776499e-02, -3.69643062e-01, -3.71046700e-02,  5.28175116e-01], 0, 1., 0,  0.0028083 , -0.6571924 )],
       dtype=[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')])
Out[3]: ([ 0.07357765, -0.36964306, -0.03710467,  0.5281751 ], 0, 1., 0, 0.0028083, -0.6571924)
Out[4]: ([ 0.02842397,  0.00441348, -0.02038097,  0.01620239], 0, 0., 0, -0.04899721, -0.6918252)
Traceback (most recent call last):
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3441, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-1-409526c648d1>", line 1, in <module>
    self
NameError: name 'self' is not defined
Traceback (most recent call last):
  File "/home/anthony/PycharmProjects/ppo_kata/main.py", line 125, in <module>
    for epoch in range(num_epochs):
KeyboardInterrupt