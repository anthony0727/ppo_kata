<Monitor<TimeLimit<CartPoleEnv<CartPole-v1>>>>
EnvSpec(CartPole-v1)
Box([-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38], [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38], (4,), float32)
Discrete(2)
example transition
OrderedDict([('obs', array([3.4946017e+00, 2.5102555e+38, 8.9605384e-02, 1.3814502e+38],
      dtype=float32)), ('action', 0), ('reward', 0.0), ('done', False)])
buffer spec
[('obs', '<f4', (4,)), ('action', '<i8'), ('reward', '<f8'), ('done', 'u1'), ('value', '<f4'), ('log_prob', '<f4')]
Agent(
  (actor): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=2, bias=True)
    (5): Softmax(dim=-1)
  )
  (critic): Sequential(
    (0): Linear(in_features=4, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): Tanh()
    (4): Linear(in_features=256, out_features=1, bias=True)
  )
)
7
{'pg loss': 0.15239931643009186, 'value loss': 3.981565237045288, 'entropy': 0.6921541094779968}
{'average_length': 20.166666666666668, 'average_return': 20.166666666666668, 'max_length': 28, 'max_return': 28.0}
11
{'pg loss': 0.04505791515111923, 'value loss': 4.705584526062012, 'entropy': 0.6920566558837891}
{'average_length': 24.4, 'average_return': 24.4, 'max_length': 47, 'max_return': 47.0}
15
{'pg loss': -0.16390444338321686, 'value loss': 3.935106039047241, 'entropy': 0.6925551891326904}
{'average_length': 25.071428571428573, 'average_return': 25.071428571428573, 'max_length': 55, 'max_return': 55.0}
21
{'pg loss': 0.005169456824660301, 'value loss': 3.21232008934021, 'entropy': 0.6929209232330322}
{'average_length': 23.45, 'average_return': 23.45, 'max_length': 55, 'max_return': 55.0}
26
{'pg loss': 0.1271502524614334, 'value loss': 4.059194087982178, 'entropy': 0.6927855014801025}
{'average_length': 24.16, 'average_return': 24.16, 'max_length': 55, 'max_return': 55.0}
31
{'pg loss': 0.21248462796211243, 'value loss': 4.242396354675293, 'entropy': 0.6929512619972229}
{'average_length': 24.1, 'average_return': 24.1, 'max_length': 55, 'max_return': 55.0}
36
{'pg loss': 0.03270071744918823, 'value loss': 3.819370746612549, 'entropy': 0.6927100419998169}
{'average_length': 24.34285714285714, 'average_return': 24.34285714285714, 'max_length': 55, 'max_return': 55.0}
41
{'pg loss': 0.10130249708890915, 'value loss': 3.6714541912078857, 'entropy': 0.6929360628128052}
{'average_length': 24.0, 'average_return': 24.0, 'max_length': 55, 'max_return': 55.0}
47
{'pg loss': -0.15664440393447876, 'value loss': 3.2385876178741455, 'entropy': 0.6929756999015808}
{'average_length': 23.58695652173913, 'average_return': 23.58695652173913, 'max_length': 55, 'max_return': 55.0}
54
{'pg loss': -0.17026887834072113, 'value loss': 2.780486583709717, 'entropy': 0.6930018663406372}
{'average_length': 23.11320754716981, 'average_return': 23.11320754716981, 'max_length': 55, 'max_return': 55.0}
62
{'pg loss': -0.10113359987735748, 'value loss': 2.468740463256836, 'entropy': 0.6930365562438965}
{'average_length': 21.983606557377048, 'average_return': 21.983606557377048, 'max_length': 55, 'max_return': 55.0}
69
{'pg loss': 0.012891055084764957, 'value loss': 2.9492027759552, 'entropy': 0.6930148601531982}
{'average_length': 21.470588235294116, 'average_return': 21.470588235294116, 'max_length': 55, 'max_return': 55.0}
74
{'pg loss': 0.0578572154045105, 'value loss': 3.7641375064849854, 'entropy': 0.6929244995117188}
{'average_length': 21.47945205479452, 'average_return': 21.47945205479452, 'max_length': 55, 'max_return': 55.0}
80
{'pg loss': -0.16204248368740082, 'value loss': 2.7090516090393066, 'entropy': 0.692947506904602}
{'average_length': 21.39240506329114, 'average_return': 21.39240506329114, 'max_length': 55, 'max_return': 55.0}
87
{'pg loss': -0.057183727622032166, 'value loss': 2.5517187118530273, 'entropy': 0.6929446458816528}
{'average_length': 21.127906976744185, 'average_return': 21.127906976744185, 'max_length': 55, 'max_return': 55.0}
92
{'pg loss': 0.042106371372938156, 'value loss': 3.699392795562744, 'entropy': 0.6929552555084229}
{'average_length': 21.35164835164835, 'average_return': 21.35164835164835, 'max_length': 55, 'max_return': 55.0}
98
{'pg loss': 0.058876991271972656, 'value loss': 3.2972052097320557, 'entropy': 0.6928069591522217}
{'average_length': 21.31958762886598, 'average_return': 21.31958762886598, 'max_length': 55, 'max_return': 55.0}
101
{'pg loss': 0.32156258821487427, 'value loss': 5.059625148773193, 'entropy': 0.6929693222045898}
{'average_length': 21.56, 'average_return': 21.56, 'max_length': 55, 'max_return': 55.0}
106
{'pg loss': -0.3732447326183319, 'value loss': 2.608774185180664, 'entropy': 0.6929718255996704}
{'average_length': 22.11, 'average_return': 22.11, 'max_length': 76, 'max_return': 76.0}
112
{'pg loss': -0.050671763718128204, 'value loss': 2.834338665008545, 'entropy': 0.6930814385414124}
{'average_length': 21.66, 'average_return': 21.66, 'max_length': 76, 'max_return': 76.0}
117
{'pg loss': -0.11214393377304077, 'value loss': 3.6825499534606934, 'entropy': 0.692963182926178}
{'average_length': 21.75, 'average_return': 21.75, 'max_length': 76, 'max_return': 76.0}
123
{'pg loss': 0.07124806940555573, 'value loss': 3.063955307006836, 'entropy': 0.6930860877037048}
{'average_length': 21.71, 'average_return': 21.71, 'max_length': 76, 'max_return': 76.0}
129
{'pg loss': -0.11884564906358719, 'value loss': 2.6523330211639404, 'entropy': 0.6930742263793945}
{'average_length': 21.01, 'average_return': 21.01, 'max_length': 76, 'max_return': 76.0}
134
{'pg loss': 0.06412891298532486, 'value loss': 3.3490889072418213, 'entropy': 0.6930794715881348}
{'average_length': 20.96, 'average_return': 20.96, 'max_length': 76, 'max_return': 76.0}
139
{'pg loss': -0.22166259586811066, 'value loss': 3.283946990966797, 'entropy': 0.6930111050605774}
{'average_length': 21.0, 'average_return': 21.0, 'max_length': 76, 'max_return': 76.0}
145
{'pg loss': 0.019455911591649055, 'value loss': 2.816645622253418, 'entropy': 0.6927677392959595}
{'average_length': 21.18, 'average_return': 21.18, 'max_length': 76, 'max_return': 76.0}
151
{'pg loss': -0.27091169357299805, 'value loss': 2.6197705268859863, 'entropy': 0.6926767230033875}
{'average_length': 21.14, 'average_return': 21.14, 'max_length': 76, 'max_return': 76.0}
157
{'pg loss': 0.07784271240234375, 'value loss': 3.2037713527679443, 'entropy': 0.6929555535316467}
{'average_length': 21.58, 'average_return': 21.58, 'max_length': 76, 'max_return': 76.0}
161
{'pg loss': -0.009646271355450153, 'value loss': 3.997600793838501, 'entropy': 0.692660391330719}
{'average_length': 21.9, 'average_return': 21.9, 'max_length': 76, 'max_return': 76.0}
165
{'pg loss': -0.30446717143058777, 'value loss': 3.120803117752075, 'entropy': 0.6930407881736755}
{'average_length': 22.79, 'average_return': 22.79, 'max_length': 76, 'max_return': 76.0}
Traceback (most recent call last):
  File "/home/anthony/PycharmProjects/ppo_kata/main.py", line 126, in <module>
    info = worker.run(steps=train_interval)
  File "/home/anthony/PycharmProjects/ppo_kata/main.py", line 41, in run
    self.ac = agent.act(self.obs)
  File "/home/anthony/PycharmProjects/ppo_kata/model.py", line 94, in act
    ac_dist = self._policy(obs)
  File "/home/anthony/PycharmProjects/ppo_kata/model.py", line 114, in _policy
    return Categorical(probs.cpu())
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/distributions/categorical.py", line 64, in __init__
    super(Categorical, self).__init__(batch_shape, validate_args=validate_args)
  File "/home/anthony/.pyenv/versions/dev/lib/python3.7/site-packages/torch/distributions/distribution.py", line 52, in __init__
    if not constraint.check(getattr(self, param)).all():
KeyboardInterrupt